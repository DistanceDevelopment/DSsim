---
title: "Vignette"
author: "Kieran Richards"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

#An Overview of DSsim : Distance Sampling Simulation
Distance sampling is a methodology which is often used to estimate the size of an animal population.  Unfortunately the surveys involved are often be time consuming and expensive.  _DSsim_ provides the opportunity to simulate survey designs and spot potential problems early.  The functions in _DSsim_ are made available by running this command:

```{r setup, message=FALSE, warning=FALSE}
library(DSsim)
```

There are several important functions that can be used when solving a problem with _DSsim_.  These are _make.region_, _make.density_, _make.population.description_, _make.detectability_, _make.design_, _make.ddf.analysis.list_ and _make.simulation_.  All of these are required to successfully build and run a simulation with _DSsim_ and each is described in detail here.

#The Functions
##_make.region_
This function is used to create a region object.  Region objects describe the shape and dimensions of the region as well as any gaps in the region.  There are two ways of using _make.region_ to create a region object.  The first is by passing a list of coordinates to the _coords_ and _gaps_ arguments and is shown in our example.  The second is by passing a previously constructed shapefile to the _shapefile_ argument.


###The Arguments of the _make.region_

_region.name_
    : This argument is required and specifies the name of the region

_strata.name_
    : This argument is used to specify the name of the stratum and is used when a region consists of multiple strata

_units_
    : The units used for the distances in the region given as a character, usually "m" or "km"

_area_
    : The area of the region, if this is omitted then it will be calculated

_shapefile_
    : A shapefile detailing the region

_coords_
    : If a shapefile is not given then coords must be; 
      a list of polygons which describes the shape of the region

_gaps_
    : If a shapefile is not given then coords must be;
      a list of polygons which describes the shape of the region


###An Example
```{r region.example}
#Firstly create lists to contain the polygon information for coords and gaps
coords <- gaps <- list()
#Fill the lists, making sure to "close" each polygon by setting the last coordinate pair equal to the first
coords[[1]] <- list(data.frame(x = c(0,1000,1000,0,0), y = c(0,0,
 1000,1000,0)))
gaps[[1]] <- list(data.frame(x = c(400,600,500,350,400), y = c(100,
 250,600,120,100)))
#Call make.region and store the result to a variable
region <- make.region(region.name = "study.area", units = "m", 
 coords = coords, gaps = gaps)
#Plot the region
plot(region)
```

As you can see the output is a rectangle with corners at the points given in _coords_ and a polygon removed with corners at the coordinates given in _gaps_.

##_make.density_
_make.density_ is used to create density objects.  Density objects describe how a population is distributed across a region.  There are three ways in which _make.density_ can be used to create a density object.  The first is by supplying a _density.surface_ which is a list of data.frames with columns _x_,_y_, and _density_.  The second is by passing a value for the _constant_ argument which will produce a density object with the same density everywhere and the last is by providing a _mgcv gam_ object which will be used to produce the grid.  Additionally, the density object may be edited by using the _add.hotspot_ method to add Gaussian hills to the object.

###The arguments of _make.density_

_region.obj_
    : This argument is required and specifies the Region object in which the density grid will be created

_density.surface_
    : A list of data.frames with columns _x_,_y_, and _density_, there must be one data.frame per strata

_x.space_
    : This argument is required and specifies the intervals in the grid in the x direction

_y.space_
    : This argument is required and specifies the intervals in the grid in the y direction

_constant_
    : Provides a value for a constant density across the region

_density.gam_
    : A _gam_ object created using _mgcv_


###The arguments of _add.hotspot

_object_
    : A density or simulation object

_centre_
    : An x,y-coordinate giving the centre of the hotspot

_sigma_
    : A value giving the scale parameter for a Gaussian decay

_amplitude_
    : The height of the hotspot at its centre


##An Example Using Constant Density
```{r density.example.1}
#Create the density object and store it to a variable
density = make.density(region.obj = region, x.space = 10, y.space = 10, constant = 0.5)
#Add some hotspots
density = add.hotspot(object = density, centre = c(50,200), sigma = 100, amplitude = 0.1)
density = add.hotspot(object = density, centre = c(500,700), sigma = 900, amplitude = 0.05)
density = add.hotspot(object = density, centre = c(300,100), sigma = 100, amplitude = -0.15)
```

```{r, density.example.2.setup, echo=FALSE, results='hide'}
surface = density@density.surface
```
##An Example Using a Density Surface
```{r density.example.2}
#Create the density object using a density surface and store it to a variable
density = make.density(region.obj = region, density.surface = surface, x.space = 10, y.space = 10)

#Plot the region density
plot(density)
```

The surface used in the second example was obtained by extracting the density.surface attribute of the density object created in the first example however any list of a data.frame with columns _x_,_y_, and _density_ could have been used.  The plot shows that there are Gaussian decays at the points (50,200), (500,700) and (300,100) where the hotspots were added.